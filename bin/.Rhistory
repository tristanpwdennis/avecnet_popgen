#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
scale_fill_viridis()+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
#axis.text.y = element_blank(),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
scale_fill_viridis()+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value))+
scale_fill_viridis()+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour='lightgray')+
scale_fill_viridis()+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour='gray')+
scale_fill_viridis()+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour='darkgrey')+
scale_fill_viridis()+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value, colour =ifelse(value>0.5, "black", "white"))) +
scale_fill_viridis()+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value, colour =ifelse(value>0.5, "black", "white"))) +
scale_fill_brewer(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
scale_fill_brewer(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value, colour ='darkgrey')) +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour ='darkgrey') +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour ='darkgrey',size=8) +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour ='darkgrey',size4) +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour ='darkgrey',face='bold') +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour ='darkgrey') +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour ='#969696') +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour =ifelse(value>0.5, "black", "white")) +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour =ifelse(snp$value>0.5, "black", "white")) +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour =ifelse(snp$value>0.5, "black", "white")) +
scale_fill_distiller(palette = 'Blues')+
labs(fill="Frequency", y='Gene',x='Population')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
library(viridis)
cnv <- fread('~/Projects/cease/cease_wp1c/analysis_data/cnv_calling/modal_copy_number_all.tsv', header=T)
cnv_genes <- fread('~/Projects/cease/cease_wp1c/analysis_data/cnv_calling/cnv_gene_locs.txt', header=T)
geneids <- cnv_genes$gene_id
cnv_wide <- subset(cnv, select = names(cnv) %in% geneids)
cnv_wide <- cbind(cnv$sample_id,cnv$analysis_pop, cnv_wide)
cnv_long <- pivot_longer(cnv_wide, cols = 3:31)
colnames(cnv_long) <- c('sample_id','analysis_pop','gene_id','copynumber')
cnv_long <- left_join(cnv_long, cnv_genes)
cnv_long$analysis_pop = factor(cnv_long$analysis_pop , levels=c("saudi_e","saudi_r","afgh_pak","india_b","india_m",'djibouti','ethiopia_n','ethiopia_so','sudan','yemen'), labels=c("saudi_e","saudi_r","afgh_pak","india_b","india_m",'djibouti','ethiopia_n','ethiopia_so','sudan','yemen'))
cnv_long<-cnv_long[ order(cnv_long$chrom, cnv_long$start), ]
cnv_long$gene_id <- as.factor(cnv_long$gene_id)
cnv_long %>% ggplot(aes(x=as.factor(sample_id),y=gene_id, fill=copynumber))+
geom_tile()+
facet_grid(rows=vars(family), cols=vars(analysis_pop),scales="free",space="free")+
theme_minimal()+
scale_fill_distiller(palette = 'Blues')+
labs(fill="Est. Copy Number", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
strip.text.x.top = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
strip.text.y = element_text(size=8,face="bold",angle = 0),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
cnv_long %>% ggplot(aes(x=as.factor(sample_id),y=gene_id, fill=copynumber))+
geom_tile()+
facet_grid(rows=vars(family), cols=vars(analysis_pop),scales="free",space="free")+
theme_minimal()+
scale_fill_distiller(palette = 'Blues', direction = -1)+
labs(fill="Est. Copy Number", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
strip.text.x.top = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
strip.text.y = element_text(size=8,face="bold",angle = 0),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
cnv_long %>% ggplot(aes(x=as.factor(sample_id),y=gene_id, fill=copynumber))+
geom_tile()+
facet_grid(rows=vars(family), cols=vars(analysis_pop),scales="free",space="free")+
theme_minimal()+
scale_fill_distiller(palette = 'Blues', direction = 1)+
labs(fill="Est. Copy Number", y='Gene',x='Individual')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
strip.text.x.top = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
strip.text.y = element_text(size=8,face="bold",angle = 0),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour =ifelse(snp$value>0.5, "black", "white")) +
scale_fill_distiller(palette = 'Blues', direction=1)+
labs(fill="Frequency", y='Gene',x='Population')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
snp %>% ggplot(aes(x=as.factor(name),y=effect, fill=value))+
geom_tile()+
facet_grid(rows=vars(gene),scales="free",space="free")+
theme_minimal()+
geom_text(aes(label = value), colour =ifelse(snp$value<0.5, "black", "white")) +
scale_fill_distiller(palette = 'Blues', direction=1)+
labs(fill="Frequency", y='Gene',x='Population')+
theme(
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
# axis.text.x = element_blank(),
axis.text.y = element_text(size=8,face="bold"),
#strip.text.x.bottom = element_text(size=8,face="bold", angle=90), #THE LINE THAT IS EDITED
#axis.text.y=element_text(size=15,face="bold"),
axis.text.x = element_text(size=8,face="bold",angle = 90, vjust = 0.7),
panel.border = element_blank(),
panel.grid.minor = element_blank(),
#panel.spacing = element_blank(),
plot.margin = margin(r = 0.05, l = 0.05))
